<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>netstandard2.0</TargetFramework>
  </PropertyGroup>

  <ItemGroup>
    <Reference Include="RevitAPI">
      <HintPath>C:\Program Files\Autodesk\Revit 2021\RevitAPI.dll</HintPath>
      <Private>False</Private>
    </Reference>
    <Reference Include="RevitAPIUI">
      <HintPath>C:\Program Files\Autodesk\Revit 2021\RevitAPIUI.dll</HintPath>
      <Private>False</Private>
    </Reference>
  </ItemGroup>

  <ItemGroup>
    <AddinFiles Include="$(TargetDir)publish\**\*" />
  </ItemGroup>

  <Target Name="GatherAddin" AfterTargets="Publish">
    <RemoveDir Directories="../deploy" />
    <MakeDir Directories="../deploy" />
    <Message Importance="High" Text="Executing GatherAddin target." />
    <Copy SourceFiles="Hypar.Revit.addin" DestinationFolder="..\deploy" />
    <Copy SourceFiles="@(AddinFiles)" DestinationFolder="..\deploy\Hypar.Revit\%(RecursiveDir)" />
  </Target>

  <ItemGroup>
    <DeploymentFiles Include="../deploy/**/*" />
  </ItemGroup>

  <Target Name="DeployAddin" AfterTargets="GatherAddin">
    <RemoveDir Directories="$(AppData)\Autodesk\Revit\Addins\2021\Hypar.Revit" />
    <Delete Files="$(AppData)\Autodesk\Revit\Addins\2021\Hypar.Revit.addin" />
    <Message Importance="High" Text="Executing DeployAddin Target" />
    <Copy SourceFiles="@(DeploymentFiles)" DestinationFolder="$(AppData)\Autodesk\Revit\Addins\2021\%(RecursiveDir)" />
  </Target>

  <ItemGroup>
    <PackageReference Include="Microsoft.AspNetCore.SignalR.Client" Version="1.1.0" />
    <PackageReference Include="Serilog" Version="2.9.0" />
    <PackageReference Include="Serilog.Sinks.File" Version="4.1.0" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\..\..\Elements\Elements.csproj" />
    <ProjectReference Include="..\..\..\..\..\Model\Hypar.Model.csproj" />
    <ProjectReference Include="..\..\Hypar.Revit.Converters\Hypar.Revit.Converters.csproj" />
  </ItemGroup>

</Project>
